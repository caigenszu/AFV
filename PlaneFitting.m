function [A,B,C,D]=PlaneFitting(s) 
x=s(:,1);
y=s(:,2);
z=s(:,3);
so=mean(s,1);
xo=so(:,1);
yo=so(:,2);
zo=so(:,3);
os=bsxfun(@minus,s,so);
ox=os(:,1);
oy=os(:,2);
oz=os(:,3);
oxox=sum(bsxfun(@times,ox,ox));
oyoy=sum(bsxfun(@times,oy,oy));
ozoz=sum(bsxfun(@times,oz,oz));
oxoy=sum(bsxfun(@times,ox,oy));
oxoz=sum(bsxfun(@times,ox,oz));
oyoz=sum(bsxfun(@times,oy,oz));
oxyz=[oxox,oxoy,oxoz;oxoy,oyoy,oyoz;oxoz,oyoz,ozoz];
[V,D]=eig(oxyz);
[~,t]=min([abs([D(1,1),D(2,2),D(3,3)])]);
A=V(1,t);
B=V(2,t);
C=V(3,t);
D=A*xo+B*yo+C*zo;